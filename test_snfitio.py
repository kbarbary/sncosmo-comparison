import six
import snfitio

testfile = six.StringIO("""Salt2Model
BEGIN_OF_FITPARAMS Salt2Model
DayMax 52830.9312582 0.0955792637978 
Redshift 0.285 0 F 
Color -0.0851965244482 0.0234763446173 
X0 5.65786629795e-05 1.52745001485e-06 
X1 0.937399343906 0.104657846643 
CovColorColor 0.00055113875659 -1 
CovColorDayMax -0.000120400816402 -1 
CovColorX0 -2.73917697928e-08 -1 
CovColorX1 -0.000243030293349 -1 
CovDayMaxDayMax 0.00913539566814 -1 
CovDayMaxX0 -6.85110339657e-09 -1 
CovDayMaxX1 0.00179671600917 -1 
CovX0X0 2.33310354787e-12 -1 
CovX0X1 -5.26149378235e-08 -1 
CovX1X1 0.010953264864 -1 
END_OF_FITPARAMS Salt2Model

BEGIN_OF_FITPARAMS UBVR
RestFrameMag_0_U 20.811061923 0.0551187964477 
RestFrameMag_0_B 21.2581394711 0.0292572975714 
RestFrameMag_0_V 21.3193553708 0.018953736613 
RestFrameMag_0_R 21.4013484117 0.0249582119361 
CovRestFrameMag_0_BRestFrameMag_0_R 5.64688233127e-05 -1 
CovRestFrameMag_0_BRestFrameMag_0_U 0.00148602315668 -1 
CovRestFrameMag_0_BRestFrameMag_0_V 0.000324522742461 -1 
CovRestFrameMag_0_RRestFrameMag_0_U -0.000433459683775 -1 
CovRestFrameMag_0_RRestFrameMag_0_V 0.000403047409191 -1 
CovRestFrameMag_0_URestFrameMag_0_V 0.000237228036685 -1 
END_OF_FITPARAMS UBVR

BEGIN_OF_FITPARAMS Salt2Model
DayMax 52830.9312582 0.0955792637978 
Redshift 0.285 0 F 
Color -0.0851965244482 0.0234763446173 
X0 5.65786629795e-05 1.52745001485e-06 
X1 0.937399343906 0.104657846643 
RestFrameMag_0_B 21.2581394711 0.0292572975714 
CovColorColor 0.00055113875659 -1 
CovColorDayMax -0.000120400816402 -1 
CovColorRestFrameMag_0_B 0.00052447831764 -1 
CovColorX0 -2.73917697928e-08 -1 
CovColorX1 -0.000243030293349 -1 
CovDayMaxDayMax 0.00913539566814 -1 
CovDayMaxRestFrameMag_0_B 0.000131399943822 -1 
CovDayMaxX0 -6.85110339657e-09 -1 
CovDayMaxX1 0.00179671600917 -1 
CovRestFrameMag_0_BX0 -4.4689055376e-08 -1 
CovRestFrameMag_0_BX1 0.00100854834164 -1 
CovX0X0 2.33310354787e-12 -1 
CovX0X1 -5.26149378235e-08 -1 
CovX1X1 0.010953264864 -1 
END_OF_FITPARAMS Salt2Model

@CHI2_LC 21.4700641513
@NDF_LC 25
@SNSTAT_FPHASE -14.2889168748
@SNSTAT_NLCMAX 3
@SNSTAT_NMAIN 8
@SNSTAT_NRISE 3
@SNSTAT_NTAIL 3
@SNSTAT_NLCMAXTIGHT 0
@SNSTAT_NRISETIGHT 4
@SNSTAT_SCORE 1
@SNSTAT_TIGHTSCORE 0
""")

def test_read_snfit_result():
    res = snfitio.read_snfit_result(testfile)

    # check a few things
    assert res.param_names[2] == "Color"
    assert res.cov[1,1] == 0.00055113875659
    assert res.errors["Color"] == 0.0234763446173
    
test_read_snfit_result()
